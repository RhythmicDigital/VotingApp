{"ast":null,"code":"import _regeneratorRuntime from\"/home/alex/voting-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/alex/voting-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/alex/voting-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/alex/voting-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/alex/voting-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/alex/voting-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/alex/voting-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{createContext,Component}from\"react\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";export var MyContext=/*#__PURE__*/createContext();// Define the base URL\nvar Axios=axios.create({baseURL:'http://localhost/php-login-registration-api/'});var MyContextProvider=/*#__PURE__*/function(_Component){_inherits(MyContextProvider,_Component);var _super=_createSuper(MyContextProvider);function MyContextProvider(){var _this;_classCallCheck(this,MyContextProvider);_this=_super.call(this);_this.state={showLogin:true,isAuth:false,theUser:null};_this.toggleNav=function(){var showLogin=!_this.state.showLogin;_this.setState(_objectSpread(_objectSpread({},_this.state),{},{showLogin:showLogin}));};_this.logoutUser=function(){localStorage.removeItem('loginToken');_this.setState(_objectSpread(_objectSpread({},_this.state),{},{isAuth:false}));};_this.registerUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var register;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Axios.post('register.php',{name:user.name,email:user.email,password:user.password});case 2:register=_context.sent;return _context.abrupt(\"return\",register.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.loginUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user){var login;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Axios.post('login.php',{email:user.email,password:user.password});case 2:login=_context2.sent;return _context2.abrupt(\"return\",login.data);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.isLoggedIn=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var loginToken,_yield$Axios$get,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:loginToken=localStorage.getItem('loginToken');// If inside the local-storage has the JWT token\nif(!loginToken){_context3.next=8;break;}//Adding JWT token to axios default header\nAxios.defaults.headers.common['Authorization']='bearer '+loginToken;// Fetching the user information\n_context3.next=5;return Axios.get('user-info.php');case 5:_yield$Axios$get=_context3.sent;data=_yield$Axios$get.data;// If user information is successfully received\nif(data.success&&data.user){_this.setState(_objectSpread(_objectSpread({},_this.state),{},{isAuth:true,theUser:data.user}));}case 8:case\"end\":return _context3.stop();}}},_callee3);}));_this.isLoggedIn();return _this;}// Root State\n_createClass(MyContextProvider,[{key:\"render\",value:function render(){var contextValue={rootState:this.state,toggleNav:this.toggleNav,isLoggedIn:this.isLoggedIn,registerUser:this.registerUser,loginUser:this.loginUser,logoutUser:this.logoutUser};return/*#__PURE__*/_jsx(MyContext.Provider,{value:contextValue,children:this.props.children});}}]);return MyContextProvider;}(Component);export default MyContextProvider;","map":{"version":3,"sources":["/home/alex/voting-app/src/contexts/MyContext.js"],"names":["React","createContext","Component","axios","MyContext","Axios","create","baseURL","MyContextProvider","state","showLogin","isAuth","theUser","toggleNav","setState","logoutUser","localStorage","removeItem","registerUser","user","post","name","email","password","register","data","loginUser","login","isLoggedIn","loginToken","getItem","defaults","headers","common","get","success","contextValue","rootState","props","children"],"mappings":"g8BAAA,MAAOA,CAAAA,KAAP,EAAgBC,aAAhB,CAA8BC,SAA9B,KAA+C,OAA/C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,2CACA,MAAO,IAAMC,CAAAA,SAAS,cAAGH,aAAa,EAA/B,CAEP;AACA,GAAMI,CAAAA,KAAK,CAAGF,KAAK,CAACG,MAAN,CAAa,CACvBC,OAAO,CAAE,8CADc,CAAb,CAAd,C,GAIMC,CAAAA,iB,sHACF,4BAAa,mDACT,wBADS,MAMbC,KANa,CAML,CACJC,SAAS,CAAC,IADN,CAEJC,MAAM,CAAC,KAFH,CAGJC,OAAO,CAAC,IAHJ,CANK,OAabC,SAba,CAaD,UAAM,CACd,GAAMH,CAAAA,SAAS,CAAG,CAAC,MAAKD,KAAL,CAAWC,SAA9B,CACA,MAAKI,QAAL,gCACO,MAAKL,KADZ,MAEIC,SAAS,CAATA,SAFJ,IAIH,CAnBY,OAsBbK,UAtBa,CAsBA,UAAM,CACfC,YAAY,CAACC,UAAb,CAAwB,YAAxB,EACA,MAAKH,QAAL,gCACO,MAAKL,KADZ,MAEIE,MAAM,CAAC,KAFX,IAIH,CA5BY,OA8BbO,YA9Ba,0FA8BE,iBAAOC,IAAP,qJAGYd,CAAAA,KAAK,CAACe,IAAN,CAAW,cAAX,CAA0B,CAC7CC,IAAI,CAACF,IAAI,CAACE,IADmC,CAE7CC,KAAK,CAACH,IAAI,CAACG,KAFkC,CAG7CC,QAAQ,CAACJ,IAAI,CAACI,QAH+B,CAA1B,CAHZ,QAGLC,QAHK,+CASJA,QAAQ,CAACC,IATL,wDA9BF,qEA2CbC,SA3Ca,2FA2CD,kBAAOP,IAAP,uJAGYd,CAAAA,KAAK,CAACe,IAAN,CAAW,WAAX,CAAuB,CACvCE,KAAK,CAACH,IAAI,CAACG,KAD4B,CAEvCC,QAAQ,CAACJ,IAAI,CAACI,QAFyB,CAAvB,CAHZ,QAGFI,KAHE,iDAODA,KAAK,CAACF,IAPL,0DA3CC,uEAsDbG,UAtDa,sEAsDA,6KACHC,UADG,CACUb,YAAY,CAACc,OAAb,CAAqB,YAArB,CADV,CAGT;AAHS,IAIND,UAJM,0BAML;AACAxB,KAAK,CAAC0B,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,EAAiD,UAAUJ,UAA3D,CAEA;AATK,uBAUgBxB,CAAAA,KAAK,CAAC6B,GAAN,CAAU,eAAV,CAVhB,wCAUET,IAVF,kBAUEA,IAVF,CAYL;AACA,GAAGA,IAAI,CAACU,OAAL,EAAgBV,IAAI,CAACN,IAAxB,CAA6B,CACzB,MAAKL,QAAL,gCACO,MAAKL,KADZ,MAEIE,MAAM,CAAC,IAFX,CAGIC,OAAO,CAACa,IAAI,CAACN,IAHjB,IAKH,CAnBI,wDAtDA,GAET,MAAKS,UAAL,GAFS,aAGZ,CAED;oDAyEA,iBAAQ,CACJ,GAAMQ,CAAAA,YAAY,CAAG,CACjBC,SAAS,CAAC,KAAK5B,KADE,CAEjBI,SAAS,CAAC,KAAKA,SAFE,CAGjBe,UAAU,CAAC,KAAKA,UAHC,CAIjBV,YAAY,CAAC,KAAKA,YAJD,CAKjBQ,SAAS,CAAC,KAAKA,SALE,CAMjBX,UAAU,CAAC,KAAKA,UANC,CAArB,CAQA,mBACI,KAAC,SAAD,CAAW,QAAX,EAAoB,KAAK,CAAEqB,YAA3B,UACK,KAAKE,KAAL,CAAWC,QADhB,EADJ,CAKH,C,+BA7F2BrC,S,EAiGhC,cAAeM,CAAAA,iBAAf","sourcesContent":["import React, { createContext,Component } from \"react\";\nimport axios from 'axios'\nexport const MyContext = createContext();\n\n// Define the base URL\nconst Axios = axios.create({\n    baseURL: 'http://localhost/php-login-registration-api/',\n});\n\nclass MyContextProvider extends Component{\n    constructor(){\n        super();\n        this.isLoggedIn();\n    }\n\n    // Root State\n    state = {\n        showLogin:true,\n        isAuth:false,\n        theUser:null,\n    };\n    \n    // Toggle between Login & Signup page\n    toggleNav = () => {\n        const showLogin = !this.state.showLogin;\n        this.setState({\n            ...this.state,\n            showLogin\n        })\n    }\n\n    // On Click the Log out button\n    logoutUser = () => {\n        localStorage.removeItem('loginToken');\n        this.setState({\n            ...this.state,\n            isAuth:false\n        })\n    }\n\n    registerUser = async (user) => {\n\n        // Sending the user registration request\n        const register = await Axios.post('register.php',{\n            name:user.name,\n            email:user.email,\n            password:user.password \n        });\n\n        return register.data;\n    }\n\n\n    loginUser = async (user) => {\n\n        // Sending the user Login request\n        const login = await Axios.post('login.php',{\n            email:user.email,\n            password:user.password\n        });\n        return login.data;\n    }\n\n    // Checking user logged in or not\n    isLoggedIn = async () => {\n        const loginToken = localStorage.getItem('loginToken');\n\n        // If inside the local-storage has the JWT token\n        if(loginToken){\n\n            //Adding JWT token to axios default header\n            Axios.defaults.headers.common['Authorization'] = 'bearer '+loginToken;\n\n            // Fetching the user information\n            const {data} = await Axios.get('user-info.php');\n\n            // If user information is successfully received\n            if(data.success && data.user){\n                this.setState({\n                    ...this.state,\n                    isAuth:true,\n                    theUser:data.user\n                });\n            }\n\n        }\n    }\n\n    render(){\n        const contextValue = {\n            rootState:this.state,\n            toggleNav:this.toggleNav,\n            isLoggedIn:this.isLoggedIn,\n            registerUser:this.registerUser,\n            loginUser:this.loginUser,\n            logoutUser:this.logoutUser\n        }\n        return(\n            <MyContext.Provider value={contextValue}>\n                {this.props.children}\n            </MyContext.Provider>\n        )\n    }\n\n}\n\nexport default MyContextProvider;"]},"metadata":{},"sourceType":"module"}